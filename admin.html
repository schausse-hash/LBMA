<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administration - LBMA</title>
    <link rel="icon" type="image/jpeg" href="logo-lbma.jpg">
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Oswald:wght@400;600;700&family=Work+Sans:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--primary:#1E3A5F;--accent:#CC0000;--gold:#D4AF37;--white:#FDFBF7;--cream:#F5F1E8;--dark:#1A1A1A;--success:#28a745;--danger:#dc3545;--warning:#ffc107;
              --aigles:#FF8001;--condors:#0070C0;--ducs:#375623;--faucons:#FF0000;--harfangs:#A6A6A6;--vautours:#FFFF00}
        body{font-family:'Work Sans',sans-serif;background:var(--cream);display:flex;min-height:100vh}
        .sidebar{width:240px;background:var(--dark);color:var(--white);position:fixed;height:100vh;overflow-y:auto}
        .sidebar-header{padding:1rem;background:var(--primary);display:flex;align-items:center;gap:.75rem}
        .sidebar-header img{height:40px;background:white;padding:3px;border-radius:5px}
        .sidebar-header h2{font-family:'Bebas Neue',sans-serif;font-size:1.2rem}
        .user-info{padding:.75rem 1rem;background:rgba(255,255,255,.1)}
        .user-info .username{font-family:'Oswald',sans-serif;color:var(--gold)}
        .user-info .logout-btn{background:var(--danger);color:white;border:none;padding:.4rem .75rem;margin-top:.4rem;cursor:pointer;font-size:.75rem;width:100%}
        .menu-section{padding:.4rem 1rem;font-size:.65rem;text-transform:uppercase;color:rgba(255,255,255,.5);margin-top:.75rem}
        .menu-item{display:flex;align-items:center;gap:.75rem;padding:.6rem 1rem;cursor:pointer;transition:.3s;border-left:3px solid transparent;font-size:.85rem}
        .menu-item:hover{background:rgba(255,255,255,.1)}
        .menu-item.active{background:var(--primary);border-left-color:var(--gold)}
        .menu-item.superadmin-only{background:linear-gradient(90deg,rgba(204,0,0,.3),transparent)}
        .sidebar-footer{padding:.75rem 1rem;background:rgba(0,0,0,.3);margin-top:auto}
        .sidebar-footer a{color:var(--white);text-decoration:none;opacity:.8;display:block;padding:.2rem 0;font-size:.75rem}
        .sidebar-footer a:hover{color:var(--gold)}
        .main-content{margin-left:240px;flex:1;padding:1.5rem}
        .page-header h1{font-family:'Bebas Neue',sans-serif;font-size:2rem;color:var(--primary)}
        .page-header p{color:#666;font-size:.85rem}
        .cards-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:.75rem;margin:1.5rem 0}
        .stat-card{background:var(--white);border:2px solid var(--dark);padding:.75rem;text-align:center}
        .stat-card .number{font-family:'Bebas Neue',sans-serif;font-size:1.75rem;color:var(--primary)}
        .stat-card .label{font-family:'Oswald',sans-serif;text-transform:uppercase;font-size:.65rem;color:#666}
        .content-box{background:var(--white);border:2px solid var(--dark);padding:1.25rem;margin-bottom:1.25rem}
        .content-box h2{font-family:'Oswald',sans-serif;font-size:1.1rem;color:var(--primary);margin-bottom:.75rem;border-bottom:2px solid var(--cream);padding-bottom:.4rem}
        .admin-section{display:none}
        .admin-section.active{display:block}
        .btn{padding:.4rem .75rem;font-family:'Oswald',sans-serif;border:2px solid var(--dark);cursor:pointer;transition:.3s;text-transform:uppercase;font-size:.75rem}
        .btn-success{background:var(--success);color:white;border-color:var(--success)}
        .btn-primary{background:var(--primary);color:white;border-color:var(--primary)}
        .btn-danger{background:var(--danger);color:white;border-color:var(--danger)}
        .btn-warning{background:var(--warning);color:var(--dark);border-color:var(--warning)}
        .btn-secondary{background:var(--cream);color:var(--dark)}
        .btn:hover{opacity:.9}
        .btn-small{padding:.2rem .4rem;font-size:.65rem}
        .btn-group{display:flex;gap:.4rem;flex-wrap:wrap;margin-top:.5rem}
        .form-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:.5rem;margin-bottom:.5rem}
        .form-group{margin-bottom:.5rem}
        .form-group label{display:block;font-family:'Oswald',sans-serif;font-size:.75rem;margin-bottom:.25rem;color:var(--primary)}
        .form-group input,.form-group select,.form-group textarea{width:100%;padding:.4rem;border:2px solid var(--dark);font-size:.85rem;background:var(--cream)}
        .form-group input:focus,.form-group select:focus{outline:none;border-color:var(--primary);background:var(--white)}
        .alert{padding:.6rem;margin-bottom:.75rem;border-left:4px solid;font-size:.8rem}
        .alert-info{background:#cce5ff;border-color:var(--primary)}
        .modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);z-index:2000;align-items:center;justify-content:center}
        .modal.active{display:flex}
        .modal-content{background:var(--white);border:3px solid var(--dark);width:90%;max-width:500px;max-height:90vh;overflow-y:auto}
        .modal-header{background:var(--primary);color:white;padding:.6rem 1rem;display:flex;justify-content:space-between;align-items:center}
        .modal-header h2{font-family:'Bebas Neue',sans-serif;font-size:1.1rem}
        .modal-header.danger{background:var(--danger)}
        .modal-close{background:none;border:none;color:white;font-size:1.2rem;cursor:pointer}
        .modal-body{padding:1rem}
        .toast{position:fixed;top:20px;right:20px;padding:.6rem 1.25rem;border-radius:5px;color:white;font-weight:bold;z-index:3000;font-size:.85rem}
        .toast-success{background:var(--success)}.toast-danger{background:var(--danger)}
        .item-card{background:var(--cream);border:2px solid var(--dark);padding:.6rem;margin-bottom:.4rem;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:.4rem}
        .item-card h4{font-family:'Oswald',sans-serif;color:var(--primary);font-size:.85rem}
        .item-card p{font-size:.75rem;color:#666}
        .action-btns{display:flex;gap:.25rem}
        .superadmin-content{display:none}
        body.is-superadmin .superadmin-content{display:block}
        body.is-superadmin .menu-item.superadmin-only{display:flex}
        body:not(.is-superadmin) .menu-item.superadmin-only{display:none}
        .team-color{font-weight:bold;padding:.1rem .4rem;border-radius:3px}
        .team-color.AIGLES{background:var(--aigles);color:white}
        .team-color.CONDORS{background:var(--condors);color:white}
        .team-color.DUCS{background:var(--ducs);color:white}
        .team-color.FAUCONS{background:var(--faucons);color:white}
        .team-color.HARFANGS{background:var(--harfangs);color:white}
        .team-color.VAUTOURS{background:var(--vautours);color:white}
        .status-badge{padding:.15rem .4rem;font-size:.65rem;font-family:'Oswald',sans-serif;display:inline-block}
        .status-badge.final{background:var(--success);color:white}
        .status-badge.avenir{background:var(--cream);color:#666;border:1px solid #ccc}
        .status-badge.ferie{background:var(--gold);color:var(--dark)}
        .data-table{width:100%;border-collapse:collapse;font-size:.8rem}
        .data-table th{background:var(--primary);color:white;padding:.4rem;text-align:left;font-family:'Oswald',sans-serif;font-size:.7rem}
        .data-table td{padding:.35rem;border-bottom:1px solid var(--cream)}
        .data-table tr:hover{background:var(--cream)}
        .games-list{max-height:400px;overflow-y:auto}
        .tabs{display:flex;border-bottom:2px solid var(--dark);margin-bottom:.75rem;flex-wrap:wrap}
        .tab{padding:.4rem .75rem;font-family:'Oswald',sans-serif;cursor:pointer;background:var(--cream);border:2px solid var(--dark);border-bottom:none;margin-right:.15rem;font-size:.8rem}
        .tab.active{background:var(--primary);color:white}
        .tab-content{display:none}.tab-content.active{display:block}
        .team-tab{border-top:3px solid transparent}
        .team-tab.AIGLES{border-top-color:var(--aigles)}.team-tab.CONDORS{border-top-color:var(--condors)}
        .team-tab.DUCS{border-top-color:var(--ducs)}.team-tab.FAUCONS{border-top-color:var(--faucons)}
        .team-tab.HARFANGS{border-top-color:var(--harfangs)}.team-tab.VAUTOURS{border-top-color:var(--vautours)}
        .cote-badge{padding:.2rem .5rem;font-family:'Oswald',sans-serif;font-size:.75rem;border-radius:3px}
        .cote-1{background:#ffebee;color:#c62828}.cote-2{background:#fff3e0;color:#ef6c00}
        .cote-3{background:#fffde7;color:#f9a825}.cote-4{background:#e8f5e9;color:#2e7d32}.cote-5{background:#e3f2fd;color:#1565c0}
    </style>
</head>
<body>
    <aside class="sidebar">
        <div class="sidebar-header"><img src="logo-lbma.jpg" alt="LBMA"><h2>Admin LBMA</h2></div>
        <div class="user-info">
            <div>ConnectÃ©: <span class="username" id="currentUser">Admin</span></div>
            <button class="logout-btn" onclick="logout()">ğŸšª DÃ©connexion</button>
        </div>
        <nav>
            <div class="menu-section">Principal</div>
            <div class="menu-item active" onclick="showSection('dashboard',this)">ğŸ  Tableau de Bord</div>
            <div class="menu-section">Gestion</div>
            <div class="menu-item" onclick="showSection('equipes',this)">ğŸ‘¥ Ã‰quipes & Joueurs</div>
            <div class="menu-item" onclick="showSection('calendrier',this)">ğŸ“… Calendrier</div>
            <div class="menu-item" onclick="showSection('temple',this)">ğŸ† Temple</div>
            <div class="menu-item" onclick="showSection('reglements',this)">ğŸ“‹ RÃ¨glements</div>
            <div class="menu-item" onclick="showSection('presse',this)">ğŸ“° MÃ©dias</div>
            <div class="menu-section">Live</div>
            <div class="menu-item" onclick="window.location.href='repechage-live.html'">ğŸ“‹ RepÃªchage</div>
            <div class="menu-item" onclick="window.location.href='stats-live.html'">ğŸ“Š Stats Live</div>
            <div class="menu-section superadmin-content">Super Admin</div>
            <div class="menu-item superadmin-only" onclick="showSection('users',this)">ğŸ” Utilisateurs</div>
        </nav>
        <div class="sidebar-footer">
            <a href="index.html">â† Retour au site</a>
            <a href="equipes.html" target="_blank">ğŸ‘¥ Voir Ã‰quipes</a>
            <a href="calendrier.html" target="_blank">ğŸ“… Voir Calendrier</a>
        </div>
    </aside>

    <main class="main-content">
        <!-- DASHBOARD -->
        <section id="dashboard" class="admin-section active">
            <div class="page-header"><h1>ğŸ  Tableau de Bord</h1></div>
            <div class="cards-grid">
                <div class="stat-card"><div class="number">6</div><div class="label">Ã‰quipes</div></div>
                <div class="stat-card"><div class="number" id="statJoueurs">0</div><div class="label">Joueurs</div></div>
                <div class="stat-card"><div class="number" id="statGames">0</div><div class="label">Parties</div></div>
                <div class="stat-card"><div class="number" id="statPlayed">0</div><div class="label">JouÃ©es</div></div>
            </div>
            <div class="content-box">
                <h2>âš¡ Actions Rapides</h2>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="showSection('equipes',document.querySelectorAll('.menu-item')[2])">ğŸ‘¥ Ã‰quipes</button>
                    <button class="btn btn-primary" onclick="showSection('calendrier',document.querySelectorAll('.menu-item')[3])">ğŸ“… Calendrier</button>
                    <a href="equipes.html" target="_blank" class="btn btn-success" style="text-decoration:none">ğŸŒ Voir Ã‰quipes</a>
                </div>
            </div>
        </section>

        <!-- Ã‰QUIPES & JOUEURS -->
        <section id="equipes" class="admin-section">
            <div class="page-header">
                <h1>ğŸ‘¥ Ã‰quipes & Joueurs 2025</h1>
                <p>GÃ©rez les joueurs de chaque Ã©quipe</p>
            </div>
            
            <div class="tabs" id="equipeTabs"></div>
            
            <div id="equipeContent"></div>
        </section>

        <!-- CALENDRIER -->
        <section id="calendrier" class="admin-section">
            <div class="page-header">
                <h1>ğŸ“… Calendrier des Parties</h1>
                <p>25 parties: vendredis soir + samedis matin + journÃ©es fÃ©riÃ©es</p>
            </div>
            
            <div class="content-box">
                <h2>â• Ajouter une Partie</h2>
                <div class="form-row">
                    <div class="form-group"><label>Date *</label><input type="date" id="newDate"></div>
                    <div class="form-group"><label>Jour</label>
                        <select id="newJour"><option value="SAMEDI">Samedi</option><option value="VENDREDI">Vendredi</option><option value="LUNDI">Lundi</option><option value="MARDI">Mardi</option></select>
                    </div>
                    <div class="form-group"><label>Heure *</label>
                        <select id="newHeure"><option value="8H30">8H30</option><option value="9H00">9H00</option><option value="10H00">10H00</option><option value="10H45">10H45</option><option value="11H30">11H30</option><option value="18H30">18H30</option><option value="20H00">20H00</option><option value="21H30">21H30</option></select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Visiteur *</label>
                        <select id="newVisiteur"><option value="AIGLES">Aigles</option><option value="CONDORS">Condors</option><option value="DUCS">Ducs</option><option value="FAUCONS">Faucons</option><option value="HARFANGS">Harfangs</option><option value="VAUTOURS">Vautours</option></select>
                    </div>
                    <div class="form-group"><label>Receveur (Local) *</label>
                        <select id="newLocal"><option value="AIGLES">Aigles</option><option value="CONDORS">Condors</option><option value="DUCS">Ducs</option><option value="FAUCONS">Faucons</option><option value="HARFANGS">Harfangs</option><option value="VAUTOURS">Vautours</option></select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Endroit *</label>
                        <select id="newEndroit"><option value="AUTEUIL">Auteuil</option><option value="JARRY 1">Jarry 1</option><option value="PARC DE LOUISBOURG">Parc de Louisbourg</option></select>
                    </div>
                    <div class="form-group"><label>SpÃ©cial</label>
                        <select id="newSpecial"><option value="">Aucune</option><option value="PATRIOTES">Patriotes</option><option value="ST-JEAN">St-Jean</option><option value="TRAVAIL">Travail</option></select>
                    </div>
                </div>
                <div class="btn-group"><button class="btn btn-success" onclick="addGame()">â• Ajouter</button></div>
            </div>

            <div class="content-box">
                <h2>ğŸ“‹ Parties (<span id="gameCount">0</span>)</h2>
                <div class="form-row" style="margin-bottom:.5rem">
                    <div class="form-group"><label>Mois</label><select id="filterMois" onchange="renderGames()"><option value="">Tous</option><option value="05">Mai</option><option value="06">Juin</option><option value="07">Juillet</option><option value="08">AoÃ»t</option><option value="09">Sept</option></select></div>
                </div>
                <div class="games-list" id="gamesList"></div>
            </div>
        </section>

        <!-- TEMPLE -->
        <section id="temple" class="admin-section">
            <div class="page-header"><h1>ğŸ† Temple de la RenommÃ©e</h1></div>
            <div class="content-box">
                <h2>ğŸ—ï¸ BÃ¢tisseurs</h2>
                <div class="btn-group" style="margin-bottom:.5rem"><button class="btn btn-success" onclick="openModal('batisseur')">â•</button></div>
                <div id="batisseursList"></div>
            </div>
        </section>

        <!-- RÃˆGLEMENTS -->
        <section id="reglements" class="admin-section">
            <div class="page-header"><h1>ğŸ“‹ RÃ¨glements</h1></div>
            <div class="content-box">
                <div class="form-row">
                    <div class="form-group"><label>Version</label><input type="text" id="regVersion" value="2025"></div>
                    <div class="form-group"><label>Date MAJ</label><input type="date" id="regDate"></div>
                </div>
                <div class="btn-group"><button class="btn btn-success" onclick="saveReglements()">ğŸ’¾</button><a href="reglements.html" target="_blank" class="btn btn-primary" style="text-decoration:none">ğŸŒ Voir</a></div>
            </div>
        </section>

        <!-- MÃ‰DIAS -->
        <section id="presse" class="admin-section">
            <div class="page-header"><h1>ğŸ“° MÃ©dias</h1></div>
            <div class="content-box">
                <h2>ğŸ“° Articles</h2>
                <div class="btn-group" style="margin-bottom:.5rem"><button class="btn btn-success" onclick="openModal('article')">â•</button></div>
                <div id="articlesList"></div>
            </div>
            <div class="content-box">
                <h2>ğŸ™ï¸ Podcasts</h2>
                <div class="btn-group" style="margin-bottom:.5rem"><button class="btn btn-success" onclick="openModal('podcast')">â•</button></div>
                <div id="podcastsList"></div>
            </div>
        </section>

        <!-- UTILISATEURS -->
        <section id="users" class="admin-section">
            <div class="page-header"><h1>ğŸ” Utilisateurs</h1></div>
            <div class="content-box">
                <div class="btn-group" style="margin-bottom:.5rem"><button class="btn btn-success" onclick="openModal('user')">â•</button></div>
                <table class="data-table"><thead><tr><th>User</th><th>Nom</th><th>RÃ´le</th><th>Actions</th></tr></thead><tbody id="usersList"></tbody></table>
            </div>
        </section>
    </main>

    <!-- MODALS -->
    <div id="joueurModal" class="modal">
        <div class="modal-content">
            <div class="modal-header"><h2>ğŸƒ Joueur</h2><button class="modal-close" onclick="closeModal('joueur')">Ã—</button></div>
            <div class="modal-body">
                <input type="hidden" id="joueurEquipe">
                <input type="hidden" id="joueurIdx" value="-1">
                <div class="form-group"><label>Nom complet *</label><input type="text" id="joueurNom" placeholder="Nom, PrÃ©nom"></div>
                <div class="form-group"><label>Cote *</label>
                    <select id="joueurCote">
                        <option value="1">1 - DÃ©butant</option>
                        <option value="2">2 - IntermÃ©diaire</option>
                        <option value="3" selected>3 - RÃ©gulier</option>
                        <option value="4">4 - AvancÃ©</option>
                        <option value="5">5 - Ã‰lite</option>
                    </select>
                </div>
                <div class="btn-group">
                    <button class="btn btn-success" onclick="saveJoueur()">ğŸ’¾ Sauvegarder</button>
                    <button class="btn btn-secondary" onclick="closeModal('joueur')">Annuler</button>
                </div>
            </div>
        </div>
    </div>

    <div id="gameModal" class="modal">
        <div class="modal-content">
            <div class="modal-header"><h2>ğŸ“… Modifier Partie</h2><button class="modal-close" onclick="closeModal('game')">Ã—</button></div>
            <div class="modal-body">
                <input type="hidden" id="gameId">
                <div class="form-row">
                    <div class="form-group"><label>Date</label><input type="date" id="gameDate"></div>
                    <div class="form-group"><label>Heure</label><select id="gameHeure"><option value="8H30">8H30</option><option value="9H00">9H00</option><option value="10H00">10H00</option><option value="10H45">10H45</option><option value="11H30">11H30</option><option value="18H30">18H30</option><option value="20H00">20H00</option><option value="21H30">21H30</option></select></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Visiteur</label><select id="gameVisiteur"><option value="AIGLES">Aigles</option><option value="CONDORS">Condors</option><option value="DUCS">Ducs</option><option value="FAUCONS">Faucons</option><option value="HARFANGS">Harfangs</option><option value="VAUTOURS">Vautours</option></select></div>
                    <div class="form-group"><label>Score V</label><input type="number" id="gameScoreV" min="0"></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Local</label><select id="gameLocal"><option value="AIGLES">Aigles</option><option value="CONDORS">Condors</option><option value="DUCS">Ducs</option><option value="FAUCONS">Faucons</option><option value="HARFANGS">Harfangs</option><option value="VAUTOURS">Vautours</option></select></div>
                    <div class="form-group"><label>Score L</label><input type="number" id="gameScoreL" min="0"></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Endroit</label><select id="gameEndroit"><option value="AUTEUIL">Auteuil</option><option value="JARRY 1">Jarry 1</option><option value="PARC DE LOUISBOURG">Louisbourg</option></select></div>
                    <div class="form-group"><label>Status</label><select id="gameStatus"><option value="avenir">Ã€ venir</option><option value="final">Final</option></select></div>
                </div>
                <div class="btn-group"><button class="btn btn-success" onclick="saveGame()">ğŸ’¾</button><button class="btn btn-secondary" onclick="closeModal('game')">Annuler</button></div>
            </div>
        </div>
    </div>

    <div id="batisseurModal" class="modal">
        <div class="modal-content">
            <div class="modal-header"><h2>ğŸ—ï¸ BÃ¢tisseur</h2><button class="modal-close" onclick="closeModal('batisseur')">Ã—</button></div>
            <div class="modal-body">
                <input type="hidden" id="batisseurId">
                <div class="form-group"><label>Nom</label><input type="text" id="batisseurNom"></div>
                <div class="form-group"><label>Description</label><input type="text" id="batisseurDesc"></div>
                <div class="btn-group"><button class="btn btn-success" onclick="saveBatisseur()">ğŸ’¾</button></div>
            </div>
        </div>
    </div>

    <div id="articleModal" class="modal">
        <div class="modal-content">
            <div class="modal-header"><h2>ğŸ“° Article</h2><button class="modal-close" onclick="closeModal('article')">Ã—</button></div>
            <div class="modal-body">
                <input type="hidden" id="articleId">
                <div class="form-group"><label>Titre</label><input type="text" id="articleTitre"></div>
                <div class="form-group"><label>Date</label><input type="date" id="articleDate"></div>
                <div class="form-group"><label>Extrait</label><textarea id="articleExtrait" rows="2"></textarea></div>
                <div class="form-group"><label>Lien</label><input type="url" id="articleLien"></div>
                <div class="btn-group"><button class="btn btn-success" onclick="saveArticle()">ğŸ’¾</button></div>
            </div>
        </div>
    </div>

    <div id="podcastModal" class="modal">
        <div class="modal-content">
            <div class="modal-header" style="background:#8B5CF6"><h2>ğŸ™ï¸ Podcast</h2><button class="modal-close" onclick="closeModal('podcast')">Ã—</button></div>
            <div class="modal-body">
                <input type="hidden" id="podcastId">
                <div class="form-group"><label>Nom</label><input type="text" id="podcastTitre"></div>
                <div class="form-row"><div class="form-group"><label>Ã‰pisode</label><input type="text" id="podcastEpisode"></div><div class="form-group"><label>Date</label><input type="date" id="podcastDate"></div></div>
                <div class="form-group"><label>Description</label><textarea id="podcastDesc" rows="2"></textarea></div>
                <div class="form-row"><div class="form-group"><label>DurÃ©e</label><input type="text" id="podcastDuree"></div><div class="form-group"><label>Plateforme</label><input type="text" id="podcastPlateforme"></div></div>
                <div class="form-group"><label>Lien</label><input type="url" id="podcastLien"></div>
                <div class="btn-group"><button class="btn btn-success" onclick="savePodcast()">ğŸ’¾</button></div>
            </div>
        </div>
    </div>

    <div id="userModal" class="modal">
        <div class="modal-content">
            <div class="modal-header"><h2>ğŸ” Utilisateur</h2><button class="modal-close" onclick="closeModal('user')">Ã—</button></div>
            <div class="modal-body">
                <input type="hidden" id="userIdx" value="-1">
                <div class="form-group"><label>Username</label><input type="text" id="userUsername"></div>
                <div class="form-group"><label>Mot de passe</label><input type="text" id="userPassword"></div>
                <div class="form-group"><label>Nom</label><input type="text" id="userNom"></div>
                <div class="form-group"><label>RÃ´le</label><select id="userRole"><option value="coach">Coach</option><option value="superadmin">Super Admin</option></select></div>
                <div class="btn-group"><button class="btn btn-success" onclick="saveUser()">ğŸ’¾</button></div>
            </div>
        </div>
    </div>

    <div id="confirmModal" class="modal">
        <div class="modal-content" style="max-width:280px">
            <div class="modal-header danger"><h2>âš ï¸</h2><button class="modal-close" onclick="closeModal('confirm')">Ã—</button></div>
            <div class="modal-body" style="text-align:center">
                <p id="confirmMsg" style="margin-bottom:.75rem"></p>
                <div class="btn-group" style="justify-content:center"><button class="btn btn-danger" onclick="doConfirm()">OK</button><button class="btn btn-secondary" onclick="closeModal('confirm')">Annuler</button></div>
            </div>
        </div>
    </div>

    <script>
        const KEYS = {
            session: 'lbma_admin_session',
            users: 'lbma_admin_users',
            equipes: 'lbma_equipes_2025',
            temple: 'lbma_temple_renommee',
            reglements: 'lbma_reglements',
            presse: 'lbma_revue_presse',
            calendrier: 'lbma_calendrier_2025'
        };
        
        let session, users, equipes, temple, reglements, presse, calendrier, confirmCb;
        let currentTeam = 'AIGLES';
        
        const defUsers = [{username:'admin',password:'lbma2026',role:'superadmin',nom:'Administrateur'}];
        const defTemple = {batisseurs:[{id:1,nom:"Robert Auclair",description:"Fondateur"}]};
        const defReglements = {version:"2025",lastUpdate:"2025-01-01"};
        const defPresse = {articles:[],podcasts:[]};
        const defCalendrier = {saison:"2025",parties:[]};
        const defEquipes = {
            saison:"2025",
            equipes:[
                {id:"AIGLES",nom:"Aigles",coach:"Beauregard, Keith",coachCote:3,joueurs:[{nom:"MÃ©nabo, Marc",cote:4},{nom:"Jasmin-Riel, Danick",cote:5},{nom:"Taddeo, Luke",cote:5},{nom:"Bureau, Robert",cote:3},{nom:"Beaudoin, StÃ©phane",cote:3},{nom:"SÃ©nÃ©cal, GÃ©rald",cote:3},{nom:"Garcia, Mathieu",cote:2},{nom:"Guerrera, Joe",cote:2},{nom:"Colati, Michael",cote:1},{nom:"Resler, Eric",cote:2}]},
                {id:"CONDORS",nom:"Condors",coach:"Bibeau, Alexandre",coachCote:4,joueurs:[{nom:"ChaussÃ©, Serge",cote:3},{nom:"Longtin, Sylvain",cote:4},{nom:"Dorrington, Kevin",cote:4},{nom:"Carballada, Sacha",cote:3},{nom:"LafreniÃ¨re, Ã‰ric",cote:3},{nom:"St-Onge Lachapelle, Francis",cote:3},{nom:"David, Daniel",cote:2},{nom:"Latour, Jonathan",cote:2},{nom:"Borges, Quinn",cote:2},{nom:"Saint-Georges, Derek",cote:1}]},
                {id:"DUCS",nom:"Ducs",coach:"Brisebois, Guy",coachCote:4,joueurs:[{nom:"Noel, Jean-Christophe",cote:3},{nom:"Robillard, Hugo",cote:5},{nom:"Beaudry, Steve",cote:4},{nom:"Trempe, Sasha",cote:3},{nom:"LarivÃ©e, StÃ©phane",cote:4},{nom:"Garcia, Edgar",cote:3},{nom:"Massamiri, Antony",cote:2},{nom:"Chartrand, Patrick",cote:2},{nom:"Forgues, Sylvain",cote:2},{nom:"Plante, Michel",cote:1}]},
                {id:"FAUCONS",nom:"Faucons",coach:"HÃ©tu, StÃ©phane",coachCote:3,joueurs:[{nom:"HÃ©tu, FÃ©lix",cote:4},{nom:"Monette, David",cote:4},{nom:"Ouellet-DorÃ©, Mathieu",cote:4},{nom:"Jean-Lachapelle, JÃ©rÃ©mie",cote:3},{nom:"St-Martin, AndrÃ©",cote:3},{nom:"LaverdiÃ¨re, Philippe",cote:4},{nom:"Boivin, Carl-Olivier",cote:2},{nom:"Doyon, Guyllaume",cote:2},{nom:"Turcot, SÃ©bastien",cote:2},{nom:"Saint-Georges, Sylvain",cote:1}]},
                {id:"HARFANGS",nom:"Harfangs",coach:"Hammarrenger, Benoit",coachCote:5,joueurs:[{nom:"Vaillancourt, Olivier",cote:2},{nom:"Lamontagne, Sylvain",cote:4},{nom:"Dorrington, Jason",cote:4},{nom:"Stabile, John",cote:3},{nom:"Santo, Joe",cote:3},{nom:"Heppell, StÃ©phane",cote:2},{nom:"De Michele, Giovanni",cote:2},{nom:"Marchand, SÃ©bastien",cote:2},{nom:"Bonin, Pierre",cote:2},{nom:"Roberge, Vincent",cote:2}]},
                {id:"VAUTOURS",nom:"Vautours",coach:"MÃ©nard, Michel",coachCote:2,joueurs:[{nom:"Francoeur, Mathieu",cote:5},{nom:"Collard, Ã‰ric",cote:5},{nom:"ThÃ©riault, JÃ©rÃ©my",cote:3},{nom:"Ciarlo, Gino",cote:3},{nom:"Proulx, StÃ©phane",cote:5},{nom:"Lambert, Martin",cote:3},{nom:"St-Onge, Bruno",cote:1},{nom:"Charbonneau, Daniel",cote:2},{nom:"Poulin, Christian",cote:2},{nom:"Michaud, Jean-David",cote:1}]}
            ]
        };
        
        function checkSession(){const s=localStorage.getItem(KEYS.session);if(!s){window.location.href='login.html';return false}session=JSON.parse(s);if(session.expires<Date.now()){localStorage.removeItem(KEYS.session);window.location.href='login.html';return false}document.getElementById('currentUser').textContent=session.nom||session.user;if(session.role==='superadmin')document.body.classList.add('is-superadmin');return true}
        function logout(){localStorage.removeItem(KEYS.session);window.location.href='login.html'}
        function load(key,def){const s=localStorage.getItem(key);if(s)try{return JSON.parse(s)}catch(e){}return JSON.parse(JSON.stringify(def))}
        function save(key,data){localStorage.setItem(key,JSON.stringify(data))}
        
        function init(){
            if(!checkSession())return;
            users=load(KEYS.users,defUsers);
            equipes=load(KEYS.equipes,defEquipes);
            temple=load(KEYS.temple,defTemple);
            reglements=load(KEYS.reglements,defReglements);
            presse=load(KEYS.presse,defPresse);
            calendrier=load(KEYS.calendrier,defCalendrier);
            renderAll();
        }
        
        function renderAll(){renderEquipeTabs();renderEquipeContent();renderGames();renderBatisseurs();renderArticles();renderPodcasts();renderUsers();updateStats()}
        
        function updateStats(){
            let totalJoueurs=0;
            equipes.equipes.forEach(e=>totalJoueurs+=e.joueurs.length);
            document.getElementById('statJoueurs').textContent=totalJoueurs;
            document.getElementById('statGames').textContent=calendrier.parties?.length||0;
            document.getElementById('statPlayed').textContent=(calendrier.parties||[]).filter(g=>g.status==='final').length;
        }
        
        function showSection(id,el){
            if(id==='users'&&session.role!=='superadmin')return toast('AccÃ¨s refusÃ©','danger');
            document.querySelectorAll('.admin-section').forEach(s=>s.classList.remove('active'));
            document.querySelectorAll('.menu-item').forEach(m=>m.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            if(el)el.classList.add('active');
        }
        function openModal(id){document.getElementById(id+'Modal').classList.add('active')}
        function closeModal(id){document.getElementById(id+'Modal').classList.remove('active')}
        function toast(msg,type){const t=document.createElement('div');t.className='toast toast-'+type;t.textContent=msg;document.body.appendChild(t);setTimeout(()=>t.remove(),2500)}
        function confirm(msg,cb){document.getElementById('confirmMsg').textContent=msg;confirmCb=cb;openModal('confirm')}
        function doConfirm(){if(confirmCb)confirmCb();closeModal('confirm');confirmCb=null}

        // === Ã‰QUIPES ===
        function renderEquipeTabs(){
            document.getElementById('equipeTabs').innerHTML=equipes.equipes.map(e=>`<div class="tab team-tab ${e.id} ${e.id===currentTeam?'active':''}" onclick="switchTeam('${e.id}')">${e.nom}</div>`).join('');
        }
        
        function switchTeam(id){currentTeam=id;renderEquipeTabs();renderEquipeContent()}
        
        function renderEquipeContent(){
            const eq=equipes.equipes.find(e=>e.id===currentTeam);
            if(!eq)return;
            const totalCote=eq.joueurs.reduce((s,j)=>s+j.cote,0);
            const joueursSorted=[...eq.joueurs].sort((a,b)=>b.cote-a.cote||a.nom.localeCompare(b.nom));
            
            document.getElementById('equipeContent').innerHTML=`
                <div class="content-box">
                    <h2><span class="team-color ${eq.id}">${eq.nom}</span> - Coach: ${eq.coach}</h2>
                    <p style="margin-bottom:1rem">Total cotes: <strong>${totalCote}</strong> | ${eq.joueurs.length} joueurs</p>
                    <div class="btn-group" style="margin-bottom:1rem">
                        <button class="btn btn-success" onclick="openJoueurModal('${eq.id}',-1)">â• Ajouter Joueur</button>
                    </div>
                    <table class="data-table">
                        <thead><tr><th>Nom</th><th>Cote</th><th>Actions</th></tr></thead>
                        <tbody>
                            ${joueursSorted.map((j,i)=>{
                                const realIdx=eq.joueurs.findIndex(x=>x.nom===j.nom);
                                return `<tr>
                                    <td>${j.nom}</td>
                                    <td><span class="cote-badge cote-${j.cote}">${j.cote}</span></td>
                                    <td class="action-btns">
                                        <button class="btn btn-primary btn-small" onclick="openJoueurModal('${eq.id}',${realIdx})">âœï¸</button>
                                        <button class="btn btn-danger btn-small" onclick="deleteJoueur('${eq.id}',${realIdx})">ğŸ—‘ï¸</button>
                                    </td>
                                </tr>`;
                            }).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }
        
        function openJoueurModal(equipeId,idx){
            document.getElementById('joueurEquipe').value=equipeId;
            document.getElementById('joueurIdx').value=idx;
            if(idx>=0){
                const eq=equipes.equipes.find(e=>e.id===equipeId);
                const j=eq.joueurs[idx];
                document.getElementById('joueurNom').value=j.nom;
                document.getElementById('joueurCote').value=j.cote;
            }else{
                document.getElementById('joueurNom').value='';
                document.getElementById('joueurCote').value='3';
            }
            openModal('joueur');
        }
        
        function saveJoueur(){
            const equipeId=document.getElementById('joueurEquipe').value;
            const idx=parseInt(document.getElementById('joueurIdx').value);
            const nom=document.getElementById('joueurNom').value.trim();
            const cote=parseInt(document.getElementById('joueurCote').value);
            if(!nom)return toast('Nom requis!','danger');
            
            const eq=equipes.equipes.find(e=>e.id===equipeId);
            if(idx>=0){eq.joueurs[idx]={nom,cote}}
            else{eq.joueurs.push({nom,cote})}
            
            save(KEYS.equipes,equipes);
            renderEquipeContent();
            updateStats();
            closeModal('joueur');
            toast('Joueur sauvegardÃ©!','success');
        }
        
        function deleteJoueur(equipeId,idx){
            confirm('Supprimer ce joueur?',()=>{
                const eq=equipes.equipes.find(e=>e.id===equipeId);
                eq.joueurs.splice(idx,1);
                save(KEYS.equipes,equipes);
                renderEquipeContent();
                updateStats();
                toast('SupprimÃ©!','success');
            });
        }

        // === CALENDRIER ===
        function renderGames(){
            const mois=document.getElementById('filterMois')?.value||'';
            let games=calendrier.parties||[];
            if(mois)games=games.filter(g=>g.date.split('-')[1]===mois);
            games.sort((a,b)=>a.date.localeCompare(b.date)||a.heure.localeCompare(b.heure));
            document.getElementById('gameCount').textContent=games.length;
            document.getElementById('gamesList').innerHTML=games.map(g=>`
                <div class="item-card">
                    <div style="flex:1">
                        <strong>#${g.id}</strong> ${g.jour} ${g.date} <strong>${g.heure}</strong>
                        ${g.special?'<span class="status-badge ferie">'+g.special+'</span>':''}
                        <br><span class="team-color ${g.visiteur}">${g.visiteur}</span> ${g.scoreV!==null?g.scoreV:''} vs ${g.scoreL!==null?g.scoreL:''} <span class="team-color ${g.local}">${g.local}</span>
                        <span style="color:#888;font-size:.75rem">@ ${g.endroit}</span>
                    </div>
                    <div class="action-btns">
                        <span class="status-badge ${g.status}">${g.status==='final'?'FINAL':'Ã€ VENIR'}</span>
                        <button class="btn btn-primary btn-small" onclick="editGame(${g.id})">âœï¸</button>
                        <button class="btn btn-danger btn-small" onclick="deleteGame(${g.id})">ğŸ—‘ï¸</button>
                    </div>
                </div>
            `).join('')||'<p>Aucune partie</p>';
        }
        
        function addGame(){
            const date=document.getElementById('newDate').value;
            if(!date)return toast('Date requise!','danger');
            const visiteur=document.getElementById('newVisiteur').value;
            const local=document.getElementById('newLocal').value;
            if(visiteur===local)return toast('Ã‰quipes diffÃ©rentes!','danger');
            const maxId=Math.max(0,...(calendrier.parties||[]).map(g=>g.id));
            calendrier.parties.push({
                id:maxId+1,date,jour:document.getElementById('newJour').value,heure:document.getElementById('newHeure').value,
                visiteur,local,scoreV:null,scoreL:null,endroit:document.getElementById('newEndroit').value,
                status:'avenir',special:document.getElementById('newSpecial').value
            });
            save(KEYS.calendrier,calendrier);renderGames();updateStats();toast('Partie ajoutÃ©e!','success');
            document.getElementById('newDate').value='';
        }
        
        function editGame(id){
            const g=calendrier.parties.find(x=>x.id===id);if(!g)return;
            document.getElementById('gameId').value=id;
            document.getElementById('gameDate').value=g.date;
            document.getElementById('gameHeure').value=g.heure;
            document.getElementById('gameVisiteur').value=g.visiteur;
            document.getElementById('gameLocal').value=g.local;
            document.getElementById('gameScoreV').value=g.scoreV!==null?g.scoreV:'';
            document.getElementById('gameScoreL').value=g.scoreL!==null?g.scoreL:'';
            document.getElementById('gameEndroit').value=g.endroit;
            document.getElementById('gameStatus').value=g.status;
            openModal('game');
        }
        
        function saveGame(){
            const id=parseInt(document.getElementById('gameId').value);
            const idx=calendrier.parties.findIndex(g=>g.id===id);if(idx<0)return;
            const sv=document.getElementById('gameScoreV').value;
            const sl=document.getElementById('gameScoreL').value;
            Object.assign(calendrier.parties[idx],{
                date:document.getElementById('gameDate').value,heure:document.getElementById('gameHeure').value,
                visiteur:document.getElementById('gameVisiteur').value,local:document.getElementById('gameLocal').value,
                scoreV:sv!==''?parseInt(sv):null,scoreL:sl!==''?parseInt(sl):null,
                endroit:document.getElementById('gameEndroit').value,status:document.getElementById('gameStatus').value
            });
            save(KEYS.calendrier,calendrier);renderGames();updateStats();closeModal('game');toast('OK','success');
        }
        
        function deleteGame(id){confirm('Supprimer?',()=>{calendrier.parties=calendrier.parties.filter(g=>g.id!==id);save(KEYS.calendrier,calendrier);renderGames();updateStats();toast('OK','success')})}

        // === TEMPLE ===
        function renderBatisseurs(){document.getElementById('batisseursList').innerHTML=(temple.batisseurs||[]).map(b=>`<div class="item-card"><h4>ğŸ—ï¸ ${b.nom}</h4><div class="action-btns"><button class="btn btn-primary btn-small" onclick="editBatisseur(${b.id})">âœï¸</button><button class="btn btn-danger btn-small" onclick="deleteBatisseur(${b.id})">ğŸ—‘ï¸</button></div></div>`).join('')||'Aucun'}
        function editBatisseur(id){const b=temple.batisseurs.find(x=>x.id===id);if(!b)return;document.getElementById('batisseurId').value=id;document.getElementById('batisseurNom').value=b.nom;document.getElementById('batisseurDesc').value=b.description||'';openModal('batisseur')}
        function saveBatisseur(){const id=document.getElementById('batisseurId').value;const nom=document.getElementById('batisseurNom').value.trim();if(!nom)return toast('Requis','danger');const d={nom,description:document.getElementById('batisseurDesc').value.trim()};if(id){const i=temple.batisseurs.findIndex(b=>b.id===parseInt(id));if(i>-1)temple.batisseurs[i]={...temple.batisseurs[i],...d}}else temple.batisseurs.push({id:Date.now(),...d});save(KEYS.temple,temple);renderBatisseurs();closeModal('batisseur');document.getElementById('batisseurId').value='';document.getElementById('batisseurNom').value='';toast('OK','success')}
        function deleteBatisseur(id){confirm('Supprimer?',()=>{temple.batisseurs=temple.batisseurs.filter(b=>b.id!==id);save(KEYS.temple,temple);renderBatisseurs();toast('OK','success')})}

        // === RÃˆGLEMENTS ===
        function saveReglements(){reglements.version=document.getElementById('regVersion').value;reglements.lastUpdate=document.getElementById('regDate').value;save(KEYS.reglements,reglements);toast('OK','success')}

        // === ARTICLES ===
        function renderArticles(){document.getElementById('articlesList').innerHTML=(presse.articles||[]).map(a=>`<div class="item-card"><h4>ğŸ“° ${a.titre}</h4><div class="action-btns"><button class="btn btn-primary btn-small" onclick="editArticle(${a.id})">âœï¸</button><button class="btn btn-danger btn-small" onclick="deleteArticle(${a.id})">ğŸ—‘ï¸</button></div></div>`).join('')||'Aucun'}
        function editArticle(id){const a=presse.articles.find(x=>x.id===id);if(!a)return;document.getElementById('articleId').value=id;document.getElementById('articleTitre').value=a.titre;document.getElementById('articleDate').value=a.date||'';document.getElementById('articleExtrait').value=a.extrait||'';document.getElementById('articleLien').value=a.lien||'';openModal('article')}
        function saveArticle(){const id=document.getElementById('articleId').value;const titre=document.getElementById('articleTitre').value.trim();if(!titre)return toast('Requis','danger');const d={titre,date:document.getElementById('articleDate').value,extrait:document.getElementById('articleExtrait').value,lien:document.getElementById('articleLien').value};if(!presse.articles)presse.articles=[];if(id){const i=presse.articles.findIndex(a=>a.id===parseInt(id));if(i>-1)presse.articles[i]={...presse.articles[i],...d}}else presse.articles.push({id:Date.now(),...d});save(KEYS.presse,presse);renderArticles();closeModal('article');document.getElementById('articleId').value='';document.getElementById('articleTitre').value='';toast('OK','success')}
        function deleteArticle(id){confirm('Supprimer?',()=>{presse.articles=presse.articles.filter(a=>a.id!==id);save(KEYS.presse,presse);renderArticles();toast('OK','success')})}

        // === PODCASTS ===
        function renderPodcasts(){document.getElementById('podcastsList').innerHTML=(presse.podcasts||[]).map(p=>`<div class="item-card"><h4>ğŸ™ï¸ ${p.titre} ${p.episode||''}</h4><div class="action-btns"><button class="btn btn-primary btn-small" onclick="editPodcast(${p.id})">âœï¸</button><button class="btn btn-danger btn-small" onclick="deletePodcast(${p.id})">ğŸ—‘ï¸</button></div></div>`).join('')||'Aucun'}
        function editPodcast(id){const p=presse.podcasts.find(x=>x.id===id);if(!p)return;document.getElementById('podcastId').value=id;document.getElementById('podcastTitre').value=p.titre;document.getElementById('podcastEpisode').value=p.episode||'';document.getElementById('podcastDate').value=p.date||'';document.getElementById('podcastDesc').value=p.description||'';document.getElementById('podcastDuree').value=p.duree||'';document.getElementById('podcastPlateforme').value=p.plateforme||'';document.getElementById('podcastLien').value=p.lien||'';openModal('podcast')}
        function savePodcast(){const id=document.getElementById('podcastId').value;const titre=document.getElementById('podcastTitre').value.trim();if(!titre)return toast('Requis','danger');const d={titre,episode:document.getElementById('podcastEpisode').value,date:document.getElementById('podcastDate').value,description:document.getElementById('podcastDesc').value,duree:document.getElementById('podcastDuree').value,plateforme:document.getElementById('podcastPlateforme').value,lien:document.getElementById('podcastLien').value};if(!presse.podcasts)presse.podcasts=[];if(id){const i=presse.podcasts.findIndex(p=>p.id===parseInt(id));if(i>-1)presse.podcasts[i]={...presse.podcasts[i],...d}}else presse.podcasts.push({id:Date.now(),...d});save(KEYS.presse,presse);renderPodcasts();closeModal('podcast');document.getElementById('podcastId').value='';document.getElementById('podcastTitre').value='';toast('OK','success')}
        function deletePodcast(id){confirm('Supprimer?',()=>{presse.podcasts=presse.podcasts.filter(p=>p.id!==id);save(KEYS.presse,presse);renderPodcasts();toast('OK','success')})}

        // === USERS ===
        function renderUsers(){if(session.role!=='superadmin')return;document.getElementById('usersList').innerHTML=users.map((u,i)=>`<tr><td>${u.username}</td><td>${u.nom}</td><td>${u.role}</td><td class="action-btns"><button class="btn btn-primary btn-small" onclick="editUser(${i})">âœï¸</button>${users.filter(x=>x.role==='superadmin').length>1||u.role!=='superadmin'?`<button class="btn btn-danger btn-small" onclick="deleteUser(${i})">ğŸ—‘ï¸</button>`:''}</td></tr>`).join('')}
        function editUser(idx){const u=users[idx];document.getElementById('userIdx').value=idx;document.getElementById('userUsername').value=u.username;document.getElementById('userPassword').value=u.password;document.getElementById('userNom').value=u.nom;document.getElementById('userRole').value=u.role;openModal('user')}
        function saveUser(){const idx=parseInt(document.getElementById('userIdx').value);const d={username:document.getElementById('userUsername').value.trim().toLowerCase(),password:document.getElementById('userPassword').value,nom:document.getElementById('userNom').value.trim(),role:document.getElementById('userRole').value};if(!d.username||!d.password||d.password.length<6)return toast('Requis (mdp 6+)','danger');if(idx>=0)users[idx]=d;else users.push(d);save(KEYS.users,users);renderUsers();closeModal('user');document.getElementById('userIdx').value='-1';toast('OK','success')}
        function deleteUser(idx){confirm('Supprimer?',()=>{users.splice(idx,1);save(KEYS.users,users);renderUsers();toast('OK','success')})}

        init();
    </script>
</body>
</html>
