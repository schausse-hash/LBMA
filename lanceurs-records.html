<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Records Saison - Lanceurs LBMA</title>
    <link rel="icon" type="image/jpeg" href="logo-lbma.jpg">
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Oswald:wght@400;600;700&family=Work+Sans:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--primary:#1E3A5F;--accent:#CC0000;--gold:#D4AF37;--white:#FDFBF7;--cream:#F5F1E8;--dark:#1A1A1A;--grass:#2D5016;--grass-light:#4A7C2B}
        body{font-family:'Work Sans',sans-serif;background:var(--cream);color:var(--dark)}
        .page-header{margin-top:80px;background:linear-gradient(135deg,var(--grass) 0%,var(--grass-light) 100%);color:var(--white);padding:3rem 2rem;text-align:center;position:relative;overflow:hidden}
        .page-header::before{content:'üèÜ';position:absolute;font-size:15rem;opacity:.05;top:50%;left:50%;transform:translate(-50%,-50%)}
        .page-header h1{font-family:'Bebas Neue',sans-serif;font-size:clamp(2.5rem,8vw,4rem);letter-spacing:.1em;position:relative;z-index:1}
        .page-header p{font-family:'Oswald',sans-serif;font-size:1.2rem;letter-spacing:.1em;position:relative;z-index:1;margin-top:.5rem}
        .container{max-width:1200px;margin:0 auto;padding:2rem}
        .info-box{background:rgba(212,175,55,.1);border-left:4px solid var(--gold);padding:1rem 1.5rem;margin-bottom:2rem}
        .loading{text-align:center;padding:3rem;font-family:'Oswald',sans-serif;font-size:1.5rem;color:var(--grass)}
        .records-grid{display:grid;gap:2rem}
        .record-card{background:var(--white);border:3px solid var(--dark);position:relative;transition:all .3s;overflow:hidden}
        .record-card::before{content:'';position:absolute;top:-3px;left:-3px;right:-3px;bottom:-3px;background:var(--grass);z-index:-1;transition:transform .3s}
        .record-card:hover::before{transform:translate(10px,10px)}
        .record-header{background:var(--grass);color:var(--white);padding:1.5rem 2rem;display:flex;align-items:center;gap:1rem}
        .record-icon{font-size:3rem}
        .record-title{flex:1}
        .record-category{font-family:'Bebas Neue',sans-serif;font-size:2rem;letter-spacing:.1em;line-height:1}
        .record-label{font-family:'Oswald',sans-serif;font-size:.9rem;opacity:.8;text-transform:uppercase;letter-spacing:.05em}
        .record-body{padding:2rem;display:grid;grid-template-columns:1fr 2fr 1fr;gap:2rem;align-items:center}
        .record-body.multi{grid-template-columns:1fr;gap:1.5rem}
        .record-value{text-align:center}
        .record-number{font-family:'Bebas Neue',sans-serif;font-size:5rem;color:var(--gold);line-height:1;text-shadow:3px 3px 0 rgba(0,0,0,.1)}
        .record-unit{font-family:'Oswald',sans-serif;font-size:.9rem;color:var(--grass);text-transform:uppercase;letter-spacing:.1em;margin-top:.5rem}
        .record-holder{text-align:center}
        .holder-name{font-family:'Oswald',sans-serif;font-size:1.8rem;color:var(--grass);font-weight:600;margin-bottom:.5rem}
        .holder-year{font-family:'Bebas Neue',sans-serif;font-size:1.5rem;color:var(--dark)}
        .record-note{text-align:center;font-size:.85rem;color:var(--dark);padding:.5rem 1rem;background:rgba(212,175,55,.1);border-radius:20px}
        .tie-holders{display:flex;justify-content:space-around;gap:2rem;margin-top:1rem;flex-wrap:wrap}
        .legend{background:var(--white);border:3px solid var(--dark);padding:1.5rem;margin-top:2rem}
        .legend h3{font-family:'Oswald',sans-serif;font-size:1.3rem;color:var(--grass);margin-bottom:1rem}
        .legend-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:.5rem;font-size:.9rem}
        .legend-item{display:flex;gap:.5rem}
        .legend-item strong{color:var(--grass);min-width:50px}
        /* NAV STANDARD */
        nav{position:fixed;top:0;left:0;right:0;z-index:1000;background:var(--white);box-shadow:0 2px 20px rgba(0,0,0,.1)}
        nav .nav-container{max-width:1400px;margin:0 auto;padding:.75rem 2rem;display:flex;justify-content:space-between;align-items:center}
        .logo{display:flex;align-items:center;gap:.75rem;text-decoration:none}
        .logo img{height:55px}
        nav ul{display:flex;list-style:none;gap:.5rem}
        nav li{position:relative}
        nav a{text-decoration:none;color:var(--dark);font-weight:600;text-transform:uppercase;font-size:.85rem;padding:.5rem 1rem;display:block;transition:.3s}
        nav a:hover{color:var(--primary);background:var(--cream)}
        .dropdown-content{display:none;position:absolute;top:100%;left:0;background:var(--white);min-width:220px;box-shadow:0 8px 16px rgba(0,0,0,.1);border:2px solid var(--dark);z-index:1001}
        .dropdown-content a{padding:.75rem 1rem;border-bottom:1px solid var(--cream);font-size:.8rem}
        .dropdown:hover .dropdown-content{display:block}
        .dropdown>a::after{content:' \25BC';font-size:.6rem}
        .hamburger{display:none;font-size:2rem;cursor:pointer;padding:.5rem;color:var(--dark)}
        /* FOOTER */
        footer{background:var(--dark);color:var(--white);padding:3rem 2rem}
        .footer-social{display:flex;gap:.5rem;flex-wrap:wrap}
        .social-link{display:inline-flex;align-items:center;gap:.5rem;background:rgba(255,255,255,.1);padding:.6rem 1.2rem;border-radius:5px;color:white;text-decoration:none;transition:.3s}
        .social-link:hover{background:var(--gold);color:var(--dark)}
        .footer-bottom{max-width:1400px;margin:1.5rem auto 0;padding-top:1.5rem;border-top:1px solid rgba(255,255,255,.2);text-align:center;opacity:.7;font-size:.85rem}
        .dropdown.open .dropdown-content{display:block!important}
        @media(max-width:768px){
            .hamburger{display:block}
            nav ul{display:none;position:absolute;top:100%;left:0;right:0;background:var(--white);flex-direction:column;padding:1rem;box-shadow:0 8px 16px rgba(0,0,0,.1)}
            nav ul.open{display:flex}
            .dropdown-content{position:static;box-shadow:none;border:none;border-left:3px solid var(--primary);margin-left:1rem}
            .dropdown:hover .dropdown-content{display:none}
            .dropdown.open .dropdown-content{display:block}
            .record-body{grid-template-columns:1fr}
            .record-header{flex-direction:column;text-align:center}
            .record-number{font-size:3.5rem}
        }
    </style>
</head>
<body>
    <nav>
        <div class="nav-container">
            <a href="index.html" class="logo"><img src="logo-lbma.jpg" alt="LBMA"></a>
            <div class="hamburger" onclick="document.querySelector('nav ul').classList.toggle('open')">&#9776;</div>
            <ul>
                <li><a href="index.html">Accueil</a></li>
                <li><a href="equipes.html">√âquipes</a></li>
                <li><a href="joueurs.html">Joueurs</a></li>
                <li><a href="calendrier.html">Calendrier</a></li>
                <li class="dropdown">
                    <a href="#">Statistiques</a>
                    <div class="dropdown-content">
                        <a href="classement-equipes.html">üèÜ Classement</a>
                        <a href="stats-frappeurs.html">‚öæ Frappeurs</a>
                        <a href="stats-lanceurs.html">üéØ Lanceurs</a>
                        <a href="stats-series.html">üèÜ S√©ries √âliminatoires</a>
                    </div>
                </li>
                <li class="dropdown">
                    <a href="#" style="color:var(--primary);font-weight:700">Archives</a>
                    <div class="dropdown-content">
                        <a href="archives-frappeurs.html">üìä Stats Frappeurs par Ann√©e</a>
                        <a href="frappeurs-carriere.html">‚≠ê Frappeurs - Carri√®re</a>
                        <a href="frappeurs-records.html">üèÜ Frappeurs - Records</a>
                        <a href="archives-lanceurs.html">üìä Stats Lanceurs par Ann√©e</a>
                        <a href="lanceurs-carriere.html">‚≠ê Lanceurs - Carri√®re</a>
                        <a href="lanceurs-records.html">üèÜ Lanceurs - Records</a>
                        <a href="classement-equipes.html">üìà Classements Historiques</a>
                        <a href="temple-renommee.html">üèõÔ∏è Temple de la Renomm√©e</a>
                        <a href="archives.html">üìö Archives Compl√®tes</a>
                    </div>
                </li>
                <li><a href="contact.html">Direction</a></li>
                <li><a href="admin.html" style="color:var(--accent)">Admin</a></li>
            </ul>
        </div>
    </nav>

    <div class="page-header">
        <h1>üèÜ Records d'une Saison</h1>
        <p>Les meilleures performances des lanceurs (1988-2025)</p>
    </div>

    <div class="container">
        <div class="info-box">
            <strong>‚ÑπÔ∏è Note:</strong> Records √©tablis depuis 1988. Certains records incluent des qualifications minimales (ex: minimum 100 manches lanc√©es pour la moyenne).
        </div>

        <div id="recordsContainer" class="records-grid">
            <div class="loading">‚è≥ Chargement des records...</div>
        </div>

        <div class="legend">
            <h3>üìñ L√©gende des Abr√©viations</h3>
            <div class="legend-grid">
                <div class="legend-item"><strong>PL</strong> Parties Lanc√©es</div>
                <div class="legend-item"><strong>ML</strong> Manches Lanc√©es</div>
                <div class="legend-item"><strong>V</strong> Victoires</div>
                <div class="legend-item"><strong>D</strong> D√©faites</div>
                <div class="legend-item"><strong>MOY</strong> Moyenne (PC/ML)</div>
                <div class="legend-item"><strong>RB</strong> Retraits au B√¢ton</div>
                <div class="legend-item"><strong>BB</strong> Buts sur Balles</div>
                <div class="legend-item"><strong>PC</strong> Points Compt√©s</div>
                <div class="legend-item"><strong>CS</strong> Coups S√ªrs Accord√©s</div>
            </div>
        </div>
    </div>

    <script>
        const SB_URL = 'https://xgyskiatppgaeaamjhxr.supabase.co';
        const SB_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhneXNraWF0cHBnYWVhYW1qaHhyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA0OTgxNTQsImV4cCI6MjA4NjA3NDE1NH0.67KCcUWlJij-scDoCUvZpkiCle5-mHVmy-inRk96Tac';

        // Charger toutes les donn√©es lanceurs depuis 1988
        async function loadData() {
            let all = [], offset = 0;
            while (true) {
                const res = await fetch(
                    `${SB_URL}/rest/v1/lanceurs_saison?select=nom,saison,pl,ml,v,d,n,bb,rb,pc,cs,moy&saison=gte.1988&order=nom.asc`,
                    { headers: { 'apikey': SB_KEY, 'Authorization': 'Bearer ' + SB_KEY, 'Range': `${offset}-${offset+999}` } }
                );
                const batch = await res.json();
                if (!Array.isArray(batch) || batch.length === 0) break;
                all = all.concat(batch);
                if (batch.length < 1000) break;
                offset += 1000;
            }
            return all;
        }

        // Trouver le ou les d√©tenteurs d'un record (max ou min)
        function findRecord(data, field, mode = 'max', minML = 0, minPL = 0) {
            let filtered = data.filter(r => {
                const val = parseFloat(r[field]);
                if (isNaN(val) || r[field] === null) return false;
                if (minML > 0 && (parseFloat(r.ml) || 0) < minML) return false;
                if (minPL > 0 && (parseFloat(r.pl) || 0) < minPL) return false;
                return true;
            });
            if (filtered.length === 0) return null;

            const best = mode === 'max'
                ? Math.max(...filtered.map(r => parseFloat(r[field])))
                : Math.min(...filtered.map(r => parseFloat(r[field])));

            // Trouver tous les √©gaux (arrondi √† 4 d√©cimales)
            const holders = filtered.filter(r => Math.round(parseFloat(r[field]) * 10000) === Math.round(best * 10000));
            return { value: best, holders };
        }

        // Formater la valeur selon le type
        function formatVal(val, field) {
            if (field === 'moy') return parseFloat(val).toFixed(2);
            if (field === 'ml')  return parseFloat(val) % 1 === 0 ? val : parseFloat(val).toFixed(1);
            return parseInt(val);
        }

        // G√©n√©rer le HTML d'une carte record
        function makeCard(icon, categorie, abbrev, result, field, note = '') {
            if (!result) return '';
            const { value, holders } = result;
            const valStr = formatVal(value, field);
            const isTie = holders.length > 1;

            const holdersHtml = isTie
                ? `<div class="tie-holders">
                    ${holders.map(h => `
                        <div class="record-holder">
                            <div class="holder-name">${h.nom}</div>
                            <div class="holder-year">${h.saison}</div>
                        </div>`).join('')}
                   </div>`
                : `<div class="record-holder">
                       <div class="holder-name">${holders[0].nom}</div>
                       <div class="holder-year">${holders[0].saison}</div>
                   </div>`;

            const bodyClass = isTie ? 'record-body multi' : 'record-body';

            return `
                <div class="record-card">
                    <div class="record-header">
                        <div class="record-icon">${icon}</div>
                        <div class="record-title">
                            <div class="record-category">${categorie}</div>
                            <div class="record-label">${abbrev}</div>
                        </div>
                    </div>
                    <div class="${bodyClass}">
                        <div class="record-value">
                            <div class="record-number">${valStr}</div>
                            <div class="record-unit">${abbrev}</div>
                        </div>
                        ${holdersHtml}
                        ${note ? `<div class="record-note">* ${note}</div>` : (isTie ? '' : '<div></div>')}
                    </div>
                </div>`;
        }

        async function renderRecords() {
            const container = document.getElementById('recordsContainer');
            try {
                const data = await loadData();

                const records = [
                    makeCard('‚öæ', 'Parties Lanc√©es',        'PL',     findRecord(data, 'pl',  'max'), 'pl'),
                    makeCard('üìà', 'Manches Lanc√©es',         'ML',     findRecord(data, 'ml',  'max'), 'ml'),
                    makeCard('üèÜ', 'Victoires',               'V',      findRecord(data, 'v',   'max'), 'v'),
                    makeCard('üìä', 'D√©faites',                'D',      findRecord(data, 'd',   'max'), 'd'),
                    makeCard('‚≠ê', 'Meilleure Moyenne',       'MOY',    findRecord(data, 'moy', 'min', 100), 'moy', 'Minimum 100 manches lanc√©es'),
                    makeCard('üéØ', 'Retraits au B√¢ton',       'RB',     findRecord(data, 'rb',  'max'), 'rb'),
                    makeCard('‚ú®', 'Moins de Buts sur Balles','BB Min', findRecord(data, 'bb',  'min', 100), 'bb', 'Minimum 100 manches lanc√©es'),
                    makeCard('üìâ', 'Plus de Buts sur Balles', 'BB Max', findRecord(data, 'bb',  'max'), 'bb'),
                    makeCard('üí•', 'Points Compt√©s',          'PC',     findRecord(data, 'pc',  'max'), 'pc'),
                    makeCard('üé™', 'Coups S√ªrs Accord√©s',     'CS',     findRecord(data, 'cs',  'max'), 'cs'),
                ];

                container.innerHTML = records.filter(Boolean).join('');
            } catch(e) {
                container.innerHTML = '<p style="text-align:center;padding:2rem;color:red">Erreur de chargement des donn√©es.</p>';
                console.error(e);
            }
        }

        window.addEventListener('load', renderRecords);
    </script>

    <footer>
        <div class="footer-grid" style="max-width:1400px;margin:0 auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:2rem">
            <div>
                <div style="display:flex;align-items:center;gap:1rem;margin-bottom:1rem">
                    <img src="logo-lbma.jpg" alt="LBMA" style="height:50px;background:white;padding:5px;border-radius:5px">
                    <div>
                        <div style="font-family:'Bebas Neue',sans-serif;font-size:1.5rem">LBMA</div>
                        <div style="opacity:.7;font-size:.9rem">Depuis 1976</div>
                    </div>
                </div>
                <div class="footer-social" style="margin-top:1rem">
                    <a href="https://www.facebook.com/groups/2400013274" target="_blank" class="social-link">üìò Facebook</a>
                    <a href="https://www.marqueur.com/baseball/mbr/tools/blg/index.php?nyx=1154" target="_blank" class="social-link">üìä Marqueur.com</a>
                </div>
            </div>
            <div>
                <h4 style="font-family:'Oswald',sans-serif;color:var(--gold);margin-bottom:1rem">üìä Statistiques 2026</h4>
                <ul style="list-style:none">
                    <li><a href="classement-equipes.html" style="color:white;text-decoration:none;display:block;padding:.25rem 0;opacity:.8">Classement</a></li>
                    <li><a href="stats-frappeurs.html" style="color:white;text-decoration:none;display:block;padding:.25rem 0;opacity:.8">Frappeurs</a></li>
                    <li><a href="stats-lanceurs.html" style="color:white;text-decoration:none;display:block;padding:.25rem 0;opacity:.8">Lanceurs</a></li>
                </ul>
            </div>
            <div>
                <h4 style="font-family:'Oswald',sans-serif;color:var(--gold);margin-bottom:1rem">üìö Archives</h4>
                <ul style="list-style:none">
                    <li><a href="archives-frappeurs.html" style="color:white;text-decoration:none;display:block;padding:.25rem 0;opacity:.8">Stats Frappeurs par Ann√©e</a></li>
                    <li><a href="frappeurs-carriere.html" style="color:white;text-decoration:none;display:block;padding:.25rem 0;opacity:.8">Frappeurs - Carri√®re</a></li>
                    <li><a href="archives-lanceurs.html" style="color:white;text-decoration:none;display:block;padding:.25rem 0;opacity:.8">Stats Lanceurs par Ann√©e</a></li>
                    <li><a href="lanceurs-carriere.html" style="color:white;text-decoration:none;display:block;padding:.25rem 0;opacity:.8">Lanceurs - Carri√®re</a></li>
                    <li><a href="classement-equipes.html" style="color:white;text-decoration:none;display:block;padding:.25rem 0;opacity:.8">Classements Historiques</a></li>
                    <li><a href="temple-renommee.html" style="color:white;text-decoration:none;display:block;padding:.25rem 0;opacity:.8">Temple de la Renomm√©e</a></li>
                </ul>
            </div>
            <div>
                <h4 style="font-family:'Oswald',sans-serif;color:var(--gold);margin-bottom:1rem">‚öæ La Ligue</h4>
                <ul style="list-style:none">
                    <li><a href="equipes.html" style="color:white;text-decoration:none;display:block;padding:.25rem 0;opacity:.8">√âquipes 2026</a></li>
                    <li><a href="calendrier.html" style="color:white;text-decoration:none;display:block;padding:.25rem 0;opacity:.8">Calendrier</a></li>
                    <li><a href="reglements.html" style="color:white;text-decoration:none;display:block;padding:.25rem 0;opacity:.8">R√®glements</a></li>
                    <li><a href="contact.html" style="color:white;text-decoration:none;display:block;padding:.25rem 0;opacity:.8">Direction</a></li>
                    <li><a href="liens-utiles.html" style="color:white;text-decoration:none;display:block;padding:.25rem 0;opacity:.8">Liens Utiles</a></li>
                    <li><a href="revue-presse.html" style="color:white;text-decoration:none;display:block;padding:.25rem 0;opacity:.8">M√©dias & Entrevues</a></li>
                    <li><a href="nous-contacter.html" style="color:white;text-decoration:none;display:block;padding:.25rem 0;opacity:.8">Nous Contacter</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">¬© 2026 Ligue de Balle Molle Amicale (LBMA) - Tous droits r√©serv√©s</div>
    </footer>

    <script>
    (function() {
        var isTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
        document.querySelectorAll('nav .dropdown > a').forEach(function(a) {
            a.addEventListener('click', function(e) {
                if (isTouch || window.innerWidth <= 768) {
                    e.preventDefault();
                    var parent = this.parentElement;
                    document.querySelectorAll('nav .dropdown').forEach(function(d) {
                        if (d !== parent) d.classList.remove('open');
                    });
                    parent.classList.toggle('open');
                }
            });
        });
        document.addEventListener('click', function(e) {
            if (!e.target.closest('nav')) {
                document.querySelector('nav ul')?.classList.remove('open');
                document.querySelectorAll('nav .dropdown').forEach(function(d) { d.classList.remove('open'); });
            }
        });
    })();
    </script>
    <script src="lbma-analytics.js"></script>
</body>
</html>
