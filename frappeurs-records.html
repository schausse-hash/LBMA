<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Records Frappeurs - LBMA</title>
    <link rel="icon" type="image/jpeg" href="logo-lbma.jpg">
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Oswald:wght@400;600;700&family=Work+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--primary:#1E3A5F;--accent:#CC0000;--gold:#D4AF37;--white:#FDFBF7;--cream:#F5F1E8;--dark:#1A1A1A}
        body{font-family:'Work Sans',sans-serif;background:var(--cream);color:var(--dark)}
        
        /* Navigation */
        nav{position:fixed;top:0;left:0;right:0;z-index:1000;background:var(--white);box-shadow:0 2px 20px rgba(0,0,0,.1)}
        nav .nav-container{max-width:1400px;margin:0 auto;padding:.75rem 2rem;display:flex;justify-content:space-between;align-items:center}
        .logo{display:flex;align-items:center;gap:.75rem;text-decoration:none}
        .logo img{height:55px}
        nav ul{display:flex;list-style:none;gap:.5rem}
        nav li{position:relative}
        nav a{text-decoration:none;color:var(--dark);font-weight:600;text-transform:uppercase;font-size:.85rem;padding:.5rem 1rem;display:block;transition:.3s}
        nav a:hover{color:var(--primary);background:var(--cream)}
        .dropdown-content{display:none;position:absolute;top:100%;left:0;background:var(--white);min-width:220px;box-shadow:0 8px 16px rgba(0,0,0,.1);border:2px solid var(--dark);z-index:1001}
        .dropdown-content a{padding:.75rem 1rem;border-bottom:1px solid var(--cream);font-size:.8rem}
        .dropdown:hover .dropdown-content{display:block}
        .dropdown>a::after{content:' ‚ñº';font-size:.6rem}
        
        /* Header */
        .page-header{margin-top:80px;background:linear-gradient(135deg,var(--accent) 0%,#FF3333 100%);color:var(--white);padding:3rem 2rem;text-align:center}
        .page-header h1{font-family:'Bebas Neue',sans-serif;font-size:clamp(2rem,6vw,3.5rem);letter-spacing:.1em}
        .page-header p{font-family:'Oswald',sans-serif;font-size:1.2rem;opacity:.9;margin-top:.5rem}
        
        .container{max-width:1200px;margin:0 auto;padding:2rem}
        
        /* Stats Navigation */
        .stats-nav{display:flex;justify-content:center;gap:1rem;margin-bottom:2rem;flex-wrap:wrap}
        .stats-nav a{padding:.75rem 1.5rem;background:var(--white);border:3px solid var(--dark);text-decoration:none;color:var(--dark);font-family:'Oswald',sans-serif;transition:.3s}
        .stats-nav a:hover,.stats-nav a.active{background:var(--accent);color:white;border-color:var(--accent)}
        
        /* Source indicator */
        .data-source{text-align:center;margin-bottom:1rem;font-size:.8rem;color:#888}
        .data-source .badge{display:inline-block;padding:.2rem .6rem;border-radius:10px;font-size:.7rem;font-weight:600}
        .badge.live{background:#d4edda;color:#155724}
        .badge.local{background:#fff3cd;color:#856404}

        /* Records Grid */
        .records-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:1.5rem}
        .record-card{background:var(--white);border:3px solid var(--dark);overflow:hidden}
        .record-header{background:var(--accent);color:white;padding:1rem;font-family:'Bebas Neue',sans-serif;font-size:1.3rem;letter-spacing:.05em}
        .record-body{padding:1rem}
        .record-item{padding:.75rem 0;border-bottom:1px dashed #ccc}
        .record-item:last-child{border-bottom:none}
        .record-type{font-family:'Oswald',sans-serif;font-size:.85rem;color:var(--primary);text-transform:uppercase;margin-bottom:.25rem}
        .record-value{font-weight:600}
        .record-holder{color:var(--gold);font-weight:700}

        /* Loading */
        .loading{text-align:center;padding:3rem;font-family:'Oswald',sans-serif;font-size:1.2rem;color:var(--primary)}
        
        /* Footer */
        footer{background:var(--dark);color:var(--white);padding:2rem;margin-top:3rem}
        .footer-content{max-width:1200px;margin:0 auto;text-align:center}
        .footer-links{display:flex;justify-content:center;gap:2rem;flex-wrap:wrap;margin-bottom:1rem}
        .footer-links a{color:var(--gold);text-decoration:none}
        .footer-bottom{opacity:.7;font-size:.85rem}
        
        @media(max-width:768px){
            nav ul{display:none}
            .records-grid{grid-template-columns:1fr}
        }
    </style>
</head>
<body>
    <nav>
        <div class="nav-container">
            <a href="index.html" class="logo"><img src="logo-lbma.jpg" alt="LBMA"></a>
            <ul>
                <li><a href="index.html">Accueil</a></li>
                <li class="dropdown">
                    <a href="#">Statistiques</a>
                    <div class="dropdown-content">
                        <a href="archives-frappeurs.html">üìä Stats Frappeurs par Ann√©e</a>
                        <a href="frappeurs-carriere.html">‚≠ê Frappeurs - Carri√®re</a>
                        <a href="frappeurs-records.html">üèÜ Frappeurs - Records</a>
                        <a href="archives-lanceurs.html">üìä Stats Lanceurs par Ann√©e</a>
                        <a href="lanceurs-carriere.html">‚≠ê Lanceurs - Carri√®re</a>
                        <a href="lanceurs-records.html">üèÜ Lanceurs - Records</a>
                    </div>
                </li>
                <li><a href="equipes.html">√âquipes</a></li>
                <li><a href="calendrier.html">Calendrier</a></li>
                <li><a href="classement-equipes.html">Classements</a></li>
                <li class="dropdown">
                    <a href="#">Archives</a>
                    <div class="dropdown-content">
                        <a href="archives.html">üìö Archives Compl√®tes</a>
                        <a href="archives-frappeurs.html">Stats Frappeurs par Ann√©e</a>
                        <a href="archives-lanceurs.html">Stats Lanceurs par Ann√©e</a>
                    </div>
                </li>
                <li><a href="admin.html" style="color:var(--accent)">Admin</a></li>
            </ul>
        </div>
    </nav>

    <div class="page-header">
        <h1>üèÜ RECORDS FRAPPEURS</h1>
        <p>Records en une saison (depuis 1988)</p>
    </div>

    <div class="container">
        <div class="stats-nav">
            <a href="archives-frappeurs.html">üìä Par Ann√©e</a>
            <a href="frappeurs-carriere.html">‚≠ê Carri√®re</a>
            <a href="frappeurs-records.html" class="active">üèÜ Records</a>
        </div>

        <div class="data-source" id="dataSource"></div>

        <div class="loading" id="loading">‚è≥ Chargement des records...</div>
        <div class="records-grid" id="recordsGrid" style="display:none"></div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-links">
                <a href="index.html">Accueil</a>
                <a href="archives-frappeurs.html">Stats Frappeurs</a>
                <a href="archives-lanceurs.html">Stats Lanceurs</a>
                <a href="archives.html">Archives</a>
                <a href="temple-renommee.html">Temple de la Renomm√©e</a>
            </div>
            <div class="footer-bottom">¬© 2026 Ligue de Balle Molle Amicale (LBMA) - Tous droits r√©serv√©s</div>
        </div>
    </footer>

    <script>
        // ============================================
        // Configuration Supabase
        // ============================================
        const SUPABASE_URL = 'https://xgyskiatppgaeaamjhxr.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhneXNraWF0cHBnYWVhYW1qaHhyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA0OTgxNTQsImV4cCI6MjA4NjA3NDE1NH0.67KCcUWlJij-scDoCUvZpkiCle5-mHVmy-inRk96Tac';
        
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Ic√¥nes par cat√©gorie
        const categoryIcons = {
            'Simples': 'üéØ', 'Doubles': 'üéØ', 'Triples': 'üéØ',
            'Circuits': 'üí£', 'Coups S√ªrs': '‚öæ', 'Apparitions': 'üìä',
            'Points Compt√©s': 'üèÉ', 'Points Produits': 'üí™',
            'Moyenne': 'üìà', 'Buts sur Balles': 'üö∂',
            'Retraits': '‚ùå', 'Sacrifices': 'ü§ù'
        };

        function getIcon(categorie) {
            for (const [key, icon] of Object.entries(categoryIcons)) {
                if (categorie.includes(key)) return icon;
            }
            return 'üèÜ';
        }

        // Extraire le nom court de la cat√©gorie (ex: "Plus de Simples (1B)" ‚Üí "SIMPLES (1B)")
        function getShortCategory(categorie) {
            return categorie
                .replace(/^Plus d[e']?\s*/i, '')
                .replace(/^Meilleure\s*/i, '')
                .replace(/^Moins d[e']?\s*/i, 'Moins de ')
                .replace(/\s*-\s*Recrue$/i, '')
                .toUpperCase();
        }

        // Regrouper les records par paire (g√©n√©ral + recrue)
        function groupRecords(records) {
            const groups = {};
            records.forEach(r => {
                const shortCat = getShortCategory(r.categorie);
                if (!groups[shortCat]) groups[shortCat] = {};
                groups[shortCat][r.type || 'general'] = r;
            });
            return groups;
        }

        function renderRecords(records, source) {
            const grid = document.getElementById('recordsGrid');
            const loading = document.getElementById('loading');
            const dataSource = document.getElementById('dataSource');
            
            // Afficher la source des donn√©es
            if (source === 'supabase') {
                dataSource.innerHTML = '<span class="badge live">üü¢ Donn√©es en direct (Supabase)</span>';
            } else {
                dataSource.innerHTML = '<span class="badge local">üü° Donn√©es locales (JSON)</span>';
            }

            const groups = groupRecords(records);
            grid.innerHTML = '';

            for (const [category, types] of Object.entries(groups)) {
                const icon = getIcon(category);
                const card = document.createElement('div');
                card.className = 'record-card';

                let bodyHTML = '';

                // Record Recrue
                if (types.recrue) {
                    const r = types.recrue;
                    bodyHTML += `
                        <div class="record-item">
                            <div class="record-type">üåü Recrue</div>
                            <div class="record-value">
                                <span class="record-holder">${r.detenteur} (${r.annee})</span> avec ${r.record}
                            </div>
                        </div>`;
                }

                // Record G√©n√©ral
                if (types.general) {
                    const r = types.general;
                    bodyHTML += `
                        <div class="record-item">
                            <div class="record-type">üëë R√©gulier</div>
                            <div class="record-value">
                                <span class="record-holder">${r.detenteur} (${r.annee})</span> avec ${r.record}
                            </div>
                        </div>`;
                }

                card.innerHTML = `
                    <div class="record-header">${icon} ${category}</div>
                    <div class="record-body">${bodyHTML}</div>
                `;

                grid.appendChild(card);
            }

            loading.style.display = 'none';
            grid.style.display = 'grid';
        }

        // ============================================
        // Chargement des donn√©es
        // Priorit√©: Supabase ‚Üí fallback JSON local
        // ============================================
        async function loadRecords() {
            try {
                // Essayer Supabase d'abord
                const { data, error } = await supabase
                    .from('records_frappeurs_saison')
                    .select('*')
                    .order('id');

                if (error) throw error;
                if (data && data.length > 0) {
                    renderRecords(data, 'supabase');
                    return;
                }
            } catch (err) {
                console.warn('Supabase indisponible, chargement du JSON local...', err);
            }

            // Fallback: fichier JSON local
            try {
                const response = await fetch('frappeurs-records-saison.json');
                const data = await response.json();
                renderRecords(data, 'local');
            } catch (err) {
                document.getElementById('loading').textContent = '‚ùå Erreur de chargement des donn√©es';
                console.error('Erreur:', err);
            }
        }

        // Lancer le chargement
        loadRecords();
    </script>
</body>
</html>
